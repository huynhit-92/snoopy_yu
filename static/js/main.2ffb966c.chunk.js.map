{"version":3,"sources":["config/enviroment.js","components/Home.js","components/Watch.js","components/App.js","reportWebVitals.js","index.js"],"names":["CAPTION_HOST","fetch","path","axios","get","Home","props","search","_","throttle","self","this","state","q","then","results","setState","videos","data","items","handleChange","bind","e","target","value","className","type","placeholder","onChange","onClick","map","video","vidId","id","isObject","videoId","url","width","height","role","preventDefault","history","push","Component","Watch","changePlaying","playing","playButtonClass","onProgress","currentSecond","player","getCurrentTime","ref","getCaption","isEmpty","captions","second","caption","find","seekTo","match","params","kuroshiro","fetchVidCaption","language","fetchCaption","result","parser","parse","ignoreAttributes","text","start","parseFloat","end","translatedCaption","texts","join","translateCaption","mode","Kuroshiro","init","KuromojiAnalyzer","dictPath","convert","to","translatedCaptions","split","newCaptions","index","config","youtube","playerVars","showinfo","controls","ReactHtmlParser","BasicExample","exact","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2ffb966c.chunk.js","sourcesContent":["import axios from 'axios'\n\nexport const API_KEY = \"AIzaSyAlfy4z3ic61tExYEvrZNUJiaPMoq1DkFs\"\nexport const HOST = \"https://youtube.googleapis.com/youtube/v3/\"\nexport const CAPTION_HOST = \"https://video.google.com/timedtext?\"\nexport function fetch(path) {\n  return axios.get(HOST + path + `key=${API_KEY}`)\n}\nexport function fetchCaption(vidId, language = \"ja\") {\n  return axios.get(CAPTION_HOST + `lang=${language}&v=${vidId}`)\n}\n","import { Component } from \"react\"\nimport { fetch } from \"../config/enviroment\"\nimport ReactPlayer from 'react-player'\nimport _ from 'lodash'\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      q: \"\",\n      videos: []\n    }\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.search()\n  }\n\n  handleChange(e) {\n    this.setState({q: e.target.value})\n    this.search()\n  }\n\n  search = _.throttle(function () {\n    let self = this\n    let fetchVideo = !!this.state.q ? fetch(`search?part=snippet&q=${this.state.q}&type=video&videoCaption=any&`) : fetch(\"videos?chart=mostPopular&\")\n    fetchVideo.then(function (results) {\n      self.setState({ videos: results.data.items })\n    })\n  }, 1000);\n\n  render() {\n    return(\n      <div className=\"container py-2 justify-content-center\">\n        <div className=\"row justify-content-center\">\n          <div className=\"input-group col-md-4\">\n            <input className=\"form-control py-2 border-right-0 border\" type=\"search\" value={this.state.q} placeholder=\"search\" onChange={this.handleChange} />\n            <span className=\"input-group-append\">\n              <button className=\"btn btn-outline-secondary border-left-0 border\" type=\"button\" onClick={() => this.search() }>\n                  <i className=\"fa fa-search\"></i>\n              </button>\n            </span>\n          </div>\n        </div>\n        { this.state.videos.map((video) => {\n            let vidId = video.id\n            if (_.isObject(vidId)) { vidId = vidId.videoId }\n            return  <div className=\"row justify-content-center mt-3\">\n                <div className=\"input-group justify-content-center col-md-4\">\n                  <div className=\"card border-primary justify-content-center mb-1\">\n                    <ReactPlayer\n                      url={`https://www.youtube.com/watch?v=${vidId}`}\n                      width=\"320px\"\n                      height=\"180px\"\n                    />\n                    <div className=\"btn-toolbar justify-content-center\" role=\"toolbar\">\n                      <div className=\"btn-group\" role=\"group\" onClick={(e) => {\n                        e.preventDefault();\n                        this.props.history.push(`/watch/${vidId}`)}}>\n                        <button className=\"btn btn-default\"><i className=\"fa fa-play-circle fa-2x\"></i></button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            }\n          )\n        }\n      </div>\n    )\n  }\n}\n","import { Component } from 'react'\nimport { fetchCaption } from '../config/enviroment'\nimport ReactPlayer from 'react-player'\nimport parser from 'fast-xml-parser'\nimport _ from 'lodash'\nimport Kuroshiro from \"kuroshiro\"\nimport KuromojiAnalyzer from \"kuroshiro-analyzer-kuromoji\"\nimport ReactHtmlParser from 'react-html-parser'\n\nexport default class Watch extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      playing: false,\n      captions: [],\n      vidId: props.match.params.id,\n      currentSecond: 1,\n      kuroshiro: null\n    }\n  }\n\n  changePlaying = () => {\n    this.setState({ playing: !this.state.playing })\n  }\n\n  playButtonClass = () => {\n    let className = this.state.playing ? 'fa-pause' : 'fa-play-circle'\n    return `fa ${className} fa-2x`\n  }\n\n  componentDidMount() {\n    this.fetchVidCaption()\n  }\n\n  fetchVidCaption() {\n    fetchCaption(this.state.vidId).then((result) => {\n      let captions = parser.parse(result.data, { ignoreAttributes: false })['transcript']\n      if (_.isEmpty(captions)) { return }\n      captions = captions['text'].map(e => ({\n        text: e['#text'],\n        start: parseFloat(e['@_start']),\n        end: parseFloat(e['@_start']) + parseFloat(e['@_dur']),\n        translatedCaption: \"\"\n      }))\n      this.setState({ captions: captions })\n\n      let texts = captions.map(e => e['text']).join(\"$$$\")\n      this.translateCaption(texts, { mode: 'furigana' })\n    })\n  }\n\n  async translateCaption(texts, options = {}) {\n    if (!this.state.kuroshiro) {\n      let kuroshiro = new Kuroshiro()\n      await kuroshiro.init(new KuromojiAnalyzer({ dictPath: '/dict/' }))\n      this.setState({ kuroshiro: kuroshiro })\n    }\n    let translatedCaptions = await this.state.kuroshiro.convert(texts, {mode:\"furigana\", to:\"hiragana\"})\n    translatedCaptions = translatedCaptions.split(\"$$$\")\n    let newCaptions = _.map(this.state.captions, (e, index) => {\n      return { ...e, translatedCaption: translatedCaptions[index] }\n    })\n    this.setState({ captions: newCaptions })\n  }\n\n  onProgress = () => {\n    this.setState({ currentSecond: this.player.getCurrentTime()})\n  }\n\n  ref = player => {\n    this.player = player\n  }\n\n  getCaption = () => {\n    if (_.isEmpty(this.state.captions)) { return \"hien chua co sub\" }\n    let second = this.state.currentSecond;\n    let caption = _.find(this.state.captions, e => (e['start'] < second || e['start'] - 0.5 < second ) && second < e['end'] - 0.5)\n    return _.get(caption, 'translatedCaption')\n  }\n\n  seekTo = (second) => {\n    this.player.seekTo(this.state.currentSecond + second)\n  }\n\n  render() {\n    return(\n      <div className=\"container py-2 justify-content-center\">\n        <div className=\"input-group justify-content-center col-md-6\">\n          <ReactPlayer\n            ref={this.ref}\n            url={`https://www.youtube.com/watch?v=${this.state.vidId}`}\n            playing={this.state.playing}\n            config={{\n              youtube: {\n                playerVars: { showinfo: 1 }\n              }\n            }}\n            controls={true}\n            onProgress={this.onProgress}\n          />\n          <div className=\"btn-toolbar col-md-12 justify-content-center\" role=\"toolbar\">\n            <div className=\"btn-group justify-content-around col-md-8\" role=\"group\">\n              <button className=\"btn btn-default\" onClick={this.changePlaying}>\n                <i className=\"fa fa-backward fa-2x\"></i></button>\n              <button className=\"btn btn-default\" onClick={this.changePlaying}>\n                <i className={this.playButtonClass()}></i></button>\n              <button className=\"btn btn-default\" onClick={() => this.seekTo(10)}>\n                <i className=\"fa fa-forward fa-2x\"></i></button>\n            </div>\n          </div>\n          <div>\n            <p className=\"h4 mt-2\">{ ReactHtmlParser(this.getCaption()) }</p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link\n} from \"react-router-dom\"\nimport Home from \"./Home\"\nimport Watch from \"./Watch\"\n\nexport default function BasicExample() {\n  return (\n    <Router>\n      <div>\n        <ul>\n          <li>\n            <Link to=\"/\">Home</Link>\n          </li>\n        </ul>\n\n        <hr />\n        <Switch>\n          <Route exact path=\"/\" component={Home} />\n          <Route path=\"/watch/:id\" component={Watch} />\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport 'font-awesome/css/font-awesome.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}